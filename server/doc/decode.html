<head>
<title>Plexus: Image Decoding</title>
<link rev="Subdocument" href="Overview.html">
<link rel="Precedes" href="dir.html">
</head>
<body>
<h1>Image Decoding</h1>

The image-decoding library takes mouse offsets into an image
(generated by browsers that support &lt;IMG ISMAP&gt; like
NCSA Mosaic 1.1 or later) and translates them to a document
specified in the <code>map.conf</code> config file.
Currently, the library only supports bitmasks and rectangles for
specifying the coordinate mappings. <p>

For rectangles, you just need to know the bounding boxes of the various
objects.  Bitmasks require that you edit bitmaps (XBM style) and set the
pixels in each bitmask corresponding to each object (one bitmask per
object).  I use <code>xv</code> to convert the image to an X11 bitmap
(using B&amp;W dithering) then edit each file with <code>bitmap</code>
setting the bits in the image that corrispond to the object.  Then you
must convert the xbm files to raw data (by writing the resulting
<code>filename_bits[]</code> array to a file). <p>

The image-decoding library reads the configuration file specified
by the <var>decode_config</var> variable in <code>local.conf</code>.
It consists of lines like: <p>

<pre>
decode-walk config-file server/walk/walk.map
...
decode-walk default server/walk/default.html
decode-walk bitmask server/walk/astronaut.mask 106 110 server/walk/astronaut.html
decode-walk bitmask server/walk/camera.mask 106 110 server/walk/camera.html
decode-walk bitmask server/walk/earth.mask 106 110 server/walk/earth.html
decode-walk bitmask server/walk/pack.mask 106 110 server/walk/pack.html
decode-walk rect 0 0 106 110 server/walk/space.html
</pre>

The first item on the line is the thing that is being mapped.  This is
the logical name you assign when you map the decoder in the
<code>local.conf</code> configuration file (e.g., <code>map decode-walk
decode.pl &amp;do_decode($path, $query)</code>).  The second item (default,
bitmask, rect, config-file) determines the action taken for each line.
'default' is the action used if there was no <code>$query</code>. 'bitmask'
tests for the bit in the mask file, if it's set it returns the specified
file (<i>Note</i> the width and height must currently be specified for
mask files).  'rect' tests to see if the selection occured in the rectangle
specifed by the x, y, width, height data specifed, if so the it returns
the document.  'config-file' loads the specified file as another map
configuration file and searches it again.  Notice that the last line ("decode-walk
rect...") is used as a catch all, but differs from 'default'.  'default'
is used if there was <b>no</b> query sent from the browser which is the
case with old browsers that don't support the ISMAP flag.

See the <a href="http://www.bsdi.com/server/walk/">walk example source</a>
and the <a href="http://www.bsdi.com/server/walk/walk.html">demo</a> that
uses it. <p>

Thanks to Chris McRae &lt;mcrae@ckm.ucsf.edu&gt; who made configuration
files for the image decoding stuff and added the rectangle decoding, his
efforts have made it a lot easier to configure. <p>

<hr>
<a href="http://www.bsdi.com/hyplan/sanders.html"><address>Tony Sanders</address></a>
</body>
